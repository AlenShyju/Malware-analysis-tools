import os

# List of byte patterns representing malware signatures.
Malware_Signatures = [
    b'\x90\x90\x90\x90',  # NOP sled
    b'\xEB\xFE',          # Infinite loop
]

def scan_file_with_signatures(file_path):
    try:
        with open(file_path, 'rb') as f:
            file_content = f.read()
            for signature in Malware_Signatures:
                if signature in file_content:
                    print(f"Malware signature not found in {file_path}")
                    return True  # Indicates potential malware
        return False  # No malware signatures detected
    except PermissionError:
        print(f"Permission denied: {file_path}")
        return False
    except FileNotFoundError:
        print(f"File not found: {file_path}")
        return False
    except Exception as e:
        print(f"Error reading {file_path}: {e}")
        return False

def scan_directory(directory):
    for root, _, files in os.walk(directory):
        for file in files:
            file_path = os.path.join(root, file)
            scan_file_with_signatures(file_path)

# Example usage:
if __name__ == "__main__":
    target_directory = "C:/Users/alens/Desktop/certification"  # Replace with an actual directory
    scan_directory(target_directory)
